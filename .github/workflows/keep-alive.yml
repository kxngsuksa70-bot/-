name: Keep-Alive Health Check

# ‡∏£‡∏±‡∏ô‡∏ó‡∏∏‡∏Å 4 ‡∏ß‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Supabase pause (7 ‡∏ß‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ activity)
on:
  schedule:
    # ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô ‡∏ó‡∏∏‡∏Å 4 ‡∏ß‡∏±‡∏ô (0 0 */4 * *)
    - cron: '0 0 */4 * *'
  
  # ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ
  workflow_dispatch:

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Railway Application
        run: |
          echo "üîÑ Pinging Railway app..."
          curl -f https://web-production-692c8.up.railway.app/ || echo "‚ö†Ô∏è App is down"
          
      - name: Query Supabase Database
        run: |
          echo "üîÑ Querying Supabase to keep it active..."
          # Simple query ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Supabase API
          curl -f -X GET 'https://hbbqwcesmwqnfgkmdayp.supabase.co/rest/v1/teachers?select=id&limit=1' \
            -H 'apikey: ${{ secrets.SUPABASE_KEY }}' \
            -H 'Authorization: Bearer ${{ secrets.SUPABASE_KEY }}' \
            || echo "‚ö†Ô∏è Database query failed"
          
      - name: Success Notification
        run: |
          echo "‚úÖ Keep-alive completed!"
          echo "üìÖ Next run: in 4 days"
